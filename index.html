<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CBå¯è½‰å‚µç™¼è¡Œè³‡æ–™æŸ¥è©¢ç³»çµ± - Rexå¤§å”çš„168å°è‚¡æŠ•è³‡æ•™å®¤</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            background: #f5f5f5;
        }

        /* é ‚éƒ¨æ¨™é¡Œå€ */
        .header-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px 20px 20px 20px;
            text-align: center;
            position: relative;
        }
        
        .header-section .icon-title {
            font-size: 2em;
            margin-bottom: 10px;
        }
        
        .header-section h1 {
            font-size: 1.8em;
            margin-bottom: 15px;
        }
        
        .header-section .subtitle {
            font-size: 1em;
            opacity: 0.95;
            margin-bottom: 20px;
        }
        
        .date-display {
            background: rgba(255,255,255,0.2);
            backdrop-filter: blur(10px);
            display: inline-block;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 1.05em;
            margin-bottom: 20px;
        }
        
        .external-links {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .external-btn {
            background: rgba(255,255,255,0.25);
            backdrop-filter: blur(10px);
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            text-decoration: none;
            font-size: 0.95em;
            transition: all 0.3s;
            border: 1px solid rgba(255,255,255,0.3);
        }
        
        .external-btn:hover {
            background: rgba(255,255,255,0.35);
            transform: translateY(-2px);
        }
        
        .author-tag {
            margin-top: 15px;
            font-size: 0.9em;
            opacity: 0.9;
        }
        
        /* è³‡æ–™çµ±è¨ˆæ©«å¹… */
        .stats-banner {
            background: linear-gradient(90deg, #ffe5b4 0%, #ffd89b 100%);
            padding: 15px 20px;
            text-align: center;
            color: #8b4513;
            font-size: 1em;
            font-weight: bold;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        /* åŠŸèƒ½é¸å–® */
        .function-menu-container {
            background: #f8f9fa;
            padding: 15px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        
        .function-menu {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 12px;
            padding: 15px 20px;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .function-item {
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            padding: 15px 10px;
            border-radius: 10px;
            background: white;
            border: 2px solid #e0e0e0;
        }
        
        .function-item:hover {
            background: #f0f0f0;
            border-color: #667eea;
            transform: translateY(-3px);
            box-shadow: 0 4px 8px rgba(102, 126, 234, 0.2);
        }
        
        .function-item.active {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border-color: #667eea;
            box-shadow: 0 4px 8px rgba(102, 126, 234, 0.3);
        }
        
        .function-item .icon {
            font-size: 2.8em;
            margin-bottom: 8px;
            display: block;
        }
        
        .function-item .label {
            font-size: 0.9em;
            color: #333;
            font-weight: 600;
            white-space: nowrap;
        }
        
        /* å…§å®¹å€åŸŸ - åˆ‡æ›é¡¯ç¤º */
        .content-section {
            background: #f5f5f5;
            min-height: calc(100vh - 400px);
            padding: 0;
        }
        
        .section-block {
            display: none;
            padding: 40px 20px;
            animation: fadeIn 0.3s ease-in;
        }
        
        .section-block.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .section-title {
            font-size: 2em;
            color: #667eea;
            text-align: center;
            margin-bottom: 30px;
            font-weight: bold;
        }
        
        .section-title .icon {
            font-size: 1.2em;
            margin-right: 10px;
        }
        
        /* æœå°‹æ¡† */
        .search-box {
            background: white;
            border: 2px solid #667eea;
            border-radius: 12px;
            padding: 20px;
            margin: 20px auto;
            max-width: 1200px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        
        .search-title {
            font-size: 1.2em;
            color: #667eea;
            margin-bottom: 15px;
            font-weight: bold;
        }
        
        .search-input-group {
            display: flex;
            gap: 10px;
        }
        
        .search-input-group input {
            flex: 1;
            padding: 12px 15px;
            font-size: 1.1em;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-family: 'Microsoft JhengHei', Arial;
        }
        
        .search-input-group input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .search-btn {
            padding: 12px 30px;
            font-size: 1.1em;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .search-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }
        
        /* åŠŸèƒ½èªªæ˜å¡ç‰‡ */
        .info-card {
            background: white;
            border-left: 5px solid #667eea;
            padding: 15px 20px;
            border-radius: 10px;
            margin: 20px auto;
            max-width: 1200px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        
        .info-card .title {
            color: #1565c0;
            font-size: 1.1em;
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .info-card .text {
            color: #0d47a1;
            line-height: 1.6;
            margin: 5px 0;
        }
        
        /* è¡¨æ ¼æ¨£å¼ */
        .table-wrapper {
            overflow-x: auto;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin: 20px auto;
            max-width: 1200px;
            background: white;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }
        
        thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        th {
            padding: 10px 6px;
            text-align: center;
            font-weight: bold;
            font-size: 0.9em;
            border-right: 1px solid rgba(255,255,255,0.2);
            line-height: 1.3;
            vertical-align: middle;
            word-wrap: break-word;
        }
        
        /* ç‰¹å®šæ¬„ä½å¯¬åº¦èª¿æ•´ - ä¿®æ­£ç‰ˆ */
        th:nth-child(1) { min-width: 60px; max-width: 60px; }   /* CBä»£è™Ÿ */
        th:nth-child(2) { min-width: 100px; max-width: 100px; } /* CBåç¨± - åŠ å¯¬ */
        th:nth-child(3) { min-width: 60px; max-width: 60px; }   /* ç™¼è¡Œè¦æ¨¡ */
        th:nth-child(4) { min-width: 60px; max-width: 60px; }   /* æœ‰ç„¡æ“”ä¿ */
        th:nth-child(5) { min-width: 60px; max-width: 60px; }   /* è‚¡æœ¬å¤§å° */
        th:nth-child(6) { min-width: 60px; max-width: 60px; }   /* ç™¼è¡Œå¹´æœŸ */
        th:nth-child(7) { min-width: 70px; max-width: 70px; }   /* æ‰¿éŠ·åˆ¸å•† */
        th:nth-child(8) { min-width: 100px; max-width: 100px; } /* ç”¢æ¥­åˆ†é¡ - åŠ å¯¬ */
        th:nth-child(9) { min-width: 60px; max-width: 60px; }   /* æ‰¿éŠ·æ–¹å¼ */
        th:nth-child(10) { min-width: 80px; max-width: 80px; }  /* æ›ç‰Œæœ€é«˜ */
        th:nth-child(11) { min-width: 80px; max-width: 80px; }  /* æ›ç‰Œæœ€ä½ */
        
        th:last-child { border-right: none; }
        
        td {
            padding: 8px 6px;
            text-align: center;
            border-bottom: 1px solid #eee;
            font-size: 0.9em;
            line-height: 1.4;
            vertical-align: middle;
            word-wrap: break-word;
            word-break: break-word;
            overflow-wrap: break-word;
        }
        
        /* CBåç¨±æ¬„ä½ - å°æ‡‰td */
        td:nth-child(2) {
            min-width: 100px;
            max-width: 100px;
            word-wrap: break-word;
            word-break: break-word;
            line-height: 1.4;
            padding: 8px 6px;
        }
        
        /* ç”¢æ¥­åˆ†é¡æ¬„ä½ - å°æ‡‰td */
        td:nth-child(8) {
            min-width: 100px;
            max-width: 100px;
            word-wrap: break-word;
            word-break: break-word;
            font-size: 0.85em;
            line-height: 1.3;
            padding: 8px 6px;
        }
        
        /* æ›ç‰Œæœ€é«˜æ¬„ä½ - å°æ‡‰td */
        td:nth-child(10) {
            min-width: 80px;
            max-width: 80px;
        }
        
        /* æ›ç‰Œæœ€ä½æ¬„ä½ - å°æ‡‰td */
        td:nth-child(11) {
            min-width: 80px;
            max-width: 80px;
        }
        
        tbody tr:hover {
            background: #f8f9fa;
            cursor: pointer;
        }
        
        .highlight-green {
            background: #c8e6c9;
            color: #1b5e20;
            font-weight: bold;
        }
        
        .highlight-red {
            background: #ffcdd2;
            color: #b71c1c;
            font-weight: bold;
        }
        
        /* æ“”ä¿ç‹€æ…‹è‰²å¡Š */
        .guarantee-yes {
            background: #c8e6c9;
            color: #1b5e20;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
            display: inline-block;
        }
        
        .guarantee-no {
            background: #ffecb3;
            color: #f57c00;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
            display: inline-block;
        }
        
        /* æ‰¿éŠ·æ–¹å¼è‰²å¡Š */
        .method-auction {
            background: #f8bbd0;
            color: #c2185b;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
            display: inline-block;
        }
        
        .method-placement {
            background: #e1bee7;
            color: #7b1fa2;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
            display: inline-block;
        }
        
        /* çµ±è¨ˆå¡ç‰‡ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px auto;
            max-width: 1200px;
        }
        
        .stat-card {
            background: white;
            border: 2px solid #667eea;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
        }
        
        .stat-card .label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 5px;
        }
        
        .stat-card .value {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }
        
        /* å–®æª”æŸ¥è©¢ - è©³ç´°è³‡æ–™å€å¡Š */
        .detail-section {
            background: white;
            border: 2px solid #667eea;
            border-radius: 12px;
            padding: 20px;
            margin: 20px auto;
            max-width: 1200px;
        }
        
        .detail-section .section-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 20px;
            margin: -20px -20px 20px -20px;
            border-radius: 10px 10px 0 0;
            font-size: 1.2em;
            font-weight: bold;
        }
        
        .detail-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .detail-item {
            background: #f8f9fa;
            padding: 12px 15px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        
        .detail-item .label {
            font-size: 0.85em;
            color: #666;
            margin-bottom: 5px;
        }
        
        .detail-item .value {
            font-size: 1.1em;
            font-weight: bold;
            color: #333;
        }
        
        .detail-item.highlight-value .value {
            color: #667eea;
            font-size: 1.3em;
        }
        
        /* CBåç¨±æ¨™é¡Œå€ */
        .cb-title-bar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 25px;
            margin: 20px auto;
            max-width: 1200px;
            border-radius: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .cb-title-bar .main-info {
            flex: 1;
        }
        
        .cb-title-bar .cb-name {
            font-size: 1.8em;
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .cb-title-bar .cb-code {
            font-size: 1.2em;
            opacity: 0.95;
        }
        
        .cb-title-bar .key-data {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .cb-title-bar .key-item {
            background: rgba(255,255,255,0.2);
            padding: 10px 20px;
            border-radius: 8px;
            text-align: center;
        }
        
        .cb-title-bar .key-item .key-label {
            font-size: 0.85em;
            opacity: 0.9;
            margin-bottom: 5px;
        }
        
        .cb-title-bar .key-item .key-value {
            font-size: 1.4em;
            font-weight: bold;
        }
        
        /* é å°¾ */
        .footer {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-align: center;
            padding: 20px;
            margin-top: 40px;
        }
        
        /* å¹³æ¿å’Œæ‰‹æ©Ÿç‰ˆ */
        @media (max-width: 1200px) {
            .function-menu {
                grid-template-columns: repeat(4, 1fr);
                gap: 10px;
            }
        }
        
        @media (max-width: 768px) {
            .header-section {
                padding: 20px 15px 15px 15px;
            }
            .header-section h1 {
                font-size: 1.5em;
            }
            .stats-banner {
                font-size: 0.9em;
                padding: 12px 15px;
            }
            .function-menu {
                gap: 10px;
                padding: 12px 15px;
            }
            .function-item {
                padding: 12px 8px;
            }
            .function-item .icon {
                font-size: 2.2em;
                margin-bottom: 5px;
            }
            .function-item .label {
                font-size: 0.85em;
            }
            .section-title {
                font-size: 1.5em;
            }
        }
    </style>
    <!-- SheetJS for Excel parsing -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
</head>
<body>
    <!-- è¼‰å…¥æç¤º -->
    <div id="loadingScreen" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(102, 126, 234, 0.95); display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 9999; color: white;">
        <div style="font-size: 3em; margin-bottom: 20px;">ğŸ“Š</div>
        <div style="font-size: 1.5em; margin-bottom: 30px;">è¼‰å…¥è³‡æ–™ä¸­...</div>
        <div style="width: 200px; height: 4px; background: rgba(255,255,255,0.3); border-radius: 2px; overflow: hidden;">
            <div style="width: 100%; height: 100%; background: white; animation: loading 1.5s ease-in-out infinite;"></div>
        </div>
    </div>
    <style>
        @keyframes loading {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
    </style>

    <!-- é ‚éƒ¨æ¨™é¡Œå€ -->
    <div class="header-section">
        <div class="icon-title">ğŸ¯</div>
        <h1>CBå¯è½‰å‚µç™¼è¡Œè³‡æ–™æŸ¥è©¢ç³»çµ±</h1>
        <div class="subtitle">ç™¼è¡Œæ¢ä»¶ | è½‰æ›åƒ¹æ ¼ | æ›ç‰Œè¡¨ç¾ | è´–å›è³£å›æ¢ä»¶</div>
        
        <div class="date-display">
            ğŸ“… <span id="currentDate"></span>
        </div>
        
        <div class="external-links">
            <a href="https://vocus.cc/user/@rexdashu168" target="_blank" class="external-btn">ğŸ“ æ–¹æ ¼å­éƒ¨è½æ ¼</a>
            <a href="https://www.youtube.com/@RexCB168" target="_blank" class="external-btn">ğŸ¬ YouTubeé »é“</a>
        </div>
        
        <div class="author-tag">by Rexå¤§å”çš„168å°è‚¡æŠ•è³‡æ•™å®¤</div>
    </div>

    <!-- è³‡æ–™çµ±è¨ˆæ©«å¹… -->
    <div class="stats-banner" id="statsBanner">
        ğŸ“Š è³‡æ–™è¼‰å…¥ä¸­...
    </div>

    <!-- åŠŸèƒ½é¸å–® -->
    <div class="function-menu-container">
        <div class="function-menu">
            <div class="function-item active" onclick="switchSection('section1', 0)">
                <div class="icon">ğŸ”</div>
                <div class="label">å–®æª”æŸ¥è©¢</div>
            </div>
            <div class="function-item" onclick="switchSection('section2', 1)">
                <div class="icon">ğŸ“Š</div>
                <div class="label">æ‰¹æ¬¡æŸ¥è©¢</div>
            </div>
            <div class="function-item" onclick="switchSection('section3', 2)">
                <div class="icon">âš™ï¸</div>
                <div class="label">æ¢ä»¶ç¯©é¸</div>
            </div>
            <div class="function-item" onclick="switchSection('section4', 3)">
                <div class="icon">ğŸ“ˆ</div>
                <div class="label">æ›ç‰Œè¡¨ç¾</div>
            </div>
            <div class="function-item" onclick="switchSection('section5', 4)">
                <div class="icon">ğŸ’°</div>
                <div class="label">è³£å›æŸ¥è©¢</div>
            </div>
            <div class="function-item" onclick="switchSection('section6', 5)">
                <div class="icon">ğŸ¢</div>
                <div class="label">åŒå…¬å¸æ¯”è¼ƒ</div>
            </div>
            <div class="function-item" onclick="switchSection('section7', 6)">
                <div class="icon">ğŸ“…</div>
                <div class="label">æ™‚é–“è»¸æŸ¥è©¢</div>
            </div>
            <div class="function-item" onclick="switchSection('section8', 7)">
                <div class="icon">ğŸ“Š</div>
                <div class="label">å¸‚å ´çµ±è¨ˆ</div>
            </div>
        </div>
    </div>

    <!-- çµ±ä¸€æŸ¥è©¢æ¡† -->
    <div style="max-width: 1200px; margin: -10px auto 20px; padding: 0 20px;">
        <div style="background: white; border-radius: 12px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
            <div style="display: flex; gap: 10px; align-items: center;">
                <input type="text" id="searchInput1" placeholder="ğŸ” è«‹è¼¸å…¥CBä»£è™Ÿæˆ–è‚¡ç¥¨ä»£è™Ÿ (ä¾‹å¦‚: 30193 æˆ– 3019)" 
                    style="flex: 1; padding: 15px; font-size: 1.1em; border: 2px solid #ddd; border-radius: 8px;"
                    onkeypress="if(event.key==='Enter') searchCB()">
                <button onclick="searchCB()" 
                    style="padding: 15px 40px; font-size: 1.1em; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; white-space: nowrap;">
                    æŸ¥è©¢
                </button>
            </div>
        </div>
    </div>

    <!-- å…§å®¹å€åŸŸ - åˆ‡æ›é¡¯ç¤º -->
    <div class="content-section">
        <!-- 1. å–®æª”æŸ¥è©¢ -->
        <div id="section1" class="section-block active">
            <div id="result1" style="margin: 20px auto; max-width: 1200px;">
                <div style="text-align:center; padding: 100px 20px; color:#999;">
                    <div style="font-size: 3em; margin-bottom: 20px;">ğŸ”</div>
                    <div style="font-size: 1.2em;">è«‹åœ¨ä¸Šæ–¹è¼¸å…¥CBä»£è™Ÿæˆ–è‚¡ç¥¨ä»£è™Ÿé€²è¡ŒæŸ¥è©¢</div>
                    <div style="font-size: 0.9em; margin-top: 10px; opacity: 0.7;">ä¾‹å¦‚: 30193 æˆ– 3019</div>
                </div>
            </div>
        </div>
        
        <!-- 2. æ‰¹æ¬¡æŸ¥è©¢ -->
        <div id="section2" class="section-block">
            <div class="section-title">
                <span class="icon">ğŸ“Š</span>æ‰¹æ¬¡æŸ¥è©¢
            </div>
            
            <div class="info-card">
                <div class="title">ğŸ’¡ åŠŸèƒ½èªªæ˜</div>
                <div class="text">æŸ¥è©¢æ–¹å¼:è¼¸å…¥å¤šå€‹CBä»£è™Ÿ,ç”¨é€—è™Ÿåˆ†éš”</div>
                <div class="text">ä½¿ç”¨ç¯„ä¾‹:è¼¸å…¥ã€Œ24762,33901,80701ã€åŒæ™‚æŸ¥è©¢ä¸‰æª”CB</div>
            </div>
            
            <div class="search-box">
                <div class="search-title">ğŸ“Š æ‰¹æ¬¡è¼¸å…¥CBä»£è™Ÿ</div>
                <div class="search-input-group">
                    <input type="text" id="batchInput" placeholder="ä¾‹å¦‚: 24762,33901,80701">
                    <button class="search-btn" onclick="batchSearch()">æŸ¥è©¢</button>
                </div>
            </div>
            
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>CB<br>ä»£è™Ÿ</th>
                            <th>CB<br>åç¨±</th>
                            <th>ç™¼è¡Œ<br>è¦æ¨¡</th>
                            <th>æœ‰ç„¡<br>æ“”ä¿</th>
                            <th>è‚¡æœ¬<br>å¤§å°</th>
                            <th>ç™¼è¡Œ<br>å¹´æœŸ</th>
                            <th>ç™¼è¡Œ<br>åˆ¸å•†</th>
                            <th>ç”¢æ¥­<br>åˆ†é¡</th>
                            <th>æ‰¿éŠ·<br>æ–¹å¼</th>
                        </tr>
                    </thead>
                    <tbody id="batchTable">
                        <tr><td colspan="9">è«‹è¼¸å…¥CBä»£è™Ÿé€²è¡ŒæŸ¥è©¢</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- 3. æ¢ä»¶ç¯©é¸ -->
        <div id="section3" class="section-block">
            <div class="section-title">
                <span class="icon">âš™ï¸</span>æ¢ä»¶ç¯©é¸
            </div>
            
            <div class="info-card">
                <div class="title">ğŸ’¡ åŠŸèƒ½èªªæ˜</div>
                <div class="text">ä¾æ“”ä¿ã€å¹´æœŸã€è¦æ¨¡æ¢ä»¶ç¯©é¸CB</div>
            </div>
            
            <div class="search-box">
                <div class="search-title">âš™ï¸ è¨­å®šç¯©é¸æ¢ä»¶</div>
                
                <!-- ç¬¬ä¸€æ’ï¼šæ“”ä¿ã€å¹´æœŸã€è¦æ¨¡(å…­åˆ†ä½) -->
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 10px;">
                    <select id="filterGuarantee" style="padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-size: 1em;">
                        <option value="">æ“”ä¿(å…¨éƒ¨)</option>
                        <option value="æœ‰æ“”ä¿">æœ‰æ“”ä¿</option>
                        <option value="ç„¡æ“”ä¿">ç„¡æ“”ä¿</option>
                    </select>
                    <select id="filterYear" style="padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-size: 1em;">
                        <option value="">å¹´æœŸ(å…¨éƒ¨)</option>
                        <option value="2.5">2.5å¹´</option>
                        <option value="3">3å¹´</option>
                        <option value="5">5å¹´</option>
                    </select>
                    <select id="filterSize" style="padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-size: 1em;">
                        <option value="">è¦æ¨¡(å…¨éƒ¨)</option>
                        <option value="1">1-3å„„</option>
                        <option value="2">3-5å„„</option>
                        <option value="3">5-8å„„</option>
                        <option value="4">8-10å„„</option>
                        <option value="5">10å„„ä»¥ä¸Š</option>
                    </select>
                </div>
                
                <!-- ç¬¬äºŒæ’ï¼šè‚¡æœ¬(å…­åˆ†ä½)ã€è½‰æ›åƒ¹æ ¼(å…­åˆ†ä½)ã€ä¿¡ç”¨è©•ç­‰ -->
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 10px;">
                    <select id="filterCapital" style="padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-size: 1em;">
                        <option value="">è‚¡æœ¬(å…¨éƒ¨)</option>
                        <option value="1">7-10å„„</option>
                        <option value="2">10-15å„„</option>
                        <option value="3">15-30å„„</option>
                        <option value="4">30-60å„„</option>
                        <option value="5">60å„„ä»¥ä¸Š</option>
                    </select>
                    <select id="filterConvPrice" style="padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-size: 1em;">
                        <option value="">è½‰æ›åƒ¹æ ¼(å…¨éƒ¨)</option>
                        <option value="1">10-15å…ƒ</option>
                        <option value="2">15-20å…ƒ</option>
                        <option value="3">20-30å…ƒ</option>
                        <option value="4">30-40å…ƒ</option>
                        <option value="5">40-60å…ƒ</option>
                        <option value="6">60å…ƒä»¥ä¸Š</option>
                    </select>
                    <select id="filterRating" style="padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-size: 1em;">
                        <option value="">ä¿¡ç”¨è©•ç­‰(å…¨éƒ¨)</option>
                        <option value="æœ‰">æœ‰è©•ç­‰</option>
                        <option value="ç„¡">ç„¡è©•ç­‰</option>
                    </select>
                </div>
                
                <!-- ç¬¬ä¸‰æ’ï¼šæ‰¿éŠ·å•†ã€ç”¢æ¥­ã€æ‰¿éŠ·æ–¹å¼ -->
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 15px;">
                    <select id="filterUnderwriter" style="padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-size: 1em;">
                        <option value="">æ‰¿éŠ·åˆ¸å•†(å…¨éƒ¨)</option>
                        <option value="ä¸­ä¿¡è­‰åˆ¸">ä¸­ä¿¡è­‰åˆ¸</option>
                        <option value="å…ƒå¤§è­‰åˆ¸">å…ƒå¤§è­‰åˆ¸</option>
                        <option value="å…†è±è­‰åˆ¸">å…†è±è­‰åˆ¸</option>
                        <option value="å‡±åŸºè­‰åˆ¸">å‡±åŸºè­‰åˆ¸</option>
                        <option value="å°æ–°è­‰åˆ¸">å°æ–°è­‰åˆ¸</option>
                        <option value="åˆåº«è­‰åˆ¸">åˆåº«è­‰åˆ¸</option>
                        <option value="å¯Œé‚¦è­‰åˆ¸">å¯Œé‚¦è­‰åˆ¸</option>
                        <option value="æ°¸è±é‡‘è­‰">æ°¸è±é‡‘è­‰</option>
                        <option value="ç¦é‚¦è­‰åˆ¸">ç¦é‚¦è­‰åˆ¸</option>
                        <option value="è¯å—æ°¸æ˜Œ">è¯å—æ°¸æ˜Œ</option>
                    </select>
                    <select id="filterIndustry" style="padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-size: 1em;">
                        <option value="">ç”¢æ¥­åˆ†é¡(å…¨éƒ¨)</option>
                        <option value="å…‰é›»æ¥­">å…‰é›»æ¥­</option>
                        <option value="å…¶ä»–æ¥­">å…¶ä»–æ¥­</option>
                        <option value="å…¶ä»–é›»å­æ¥­">å…¶ä»–é›»å­æ¥­</option>
                        <option value="åŠå°é«”ç”¢æ¥­">åŠå°é«”ç”¢æ¥­</option>
                        <option value="å»ºæç‡Ÿé€ æ¥­">å»ºæç‡Ÿé€ æ¥­</option>
                        <option value="ç´¡ç¹”çº–ç¶­">ç´¡ç¹”çº–ç¶­</option>
                        <option value="è²¿æ˜“ç™¾è²¨æ¥­">è²¿æ˜“ç™¾è²¨æ¥­</option>
                        <option value="é€šä¿¡ç¶²è·¯æ¥­">é€šä¿¡ç¶²è·¯æ¥­</option>
                        <option value="é‡‘æ§æ¥­">é‡‘æ§æ¥­</option>
                        <option value="éŠ€è¡Œæ¥­">éŠ€è¡Œæ¥­</option>
                        <option value="é‹¼éµå·¥æ¥­">é‹¼éµå·¥æ¥­</option>
                        <option value="é›»å­é€šè·¯æ¥­">é›»å­é€šè·¯æ¥­</option>
                        <option value="é›»å­é›¶çµ„ä»¶æ¥­">é›»å­é›¶çµ„ä»¶æ¥­</option>
                        <option value="é›»æ©Ÿæ©Ÿæ¢°">é›»æ©Ÿæ©Ÿæ¢°</option>
                        <option value="é›»è…¦åŠé€±é‚Šè¨­å‚™æ¥­">é›»è…¦åŠé€±é‚Šè¨­å‚™æ¥­</option>
                    </select>
                    <select id="filterMethod" style="padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-size: 1em;">
                        <option value="">æ‰¿éŠ·æ–¹å¼(å…¨éƒ¨)</option>
                        <option value="è©¢åœˆ">è©¢åœˆ</option>
                    </select>
                </div>
                
                <button class="search-btn" onclick="filterSearch()" style="width: 100%;">ğŸ” ç¯©é¸</button>
            </div>
            
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>CB<br>ä»£è™Ÿ</th>
                            <th>CB<br>åç¨±</th>
                            <th>ç™¼è¡Œ<br>è¦æ¨¡</th>
                            <th>æœ‰ç„¡<br>æ“”ä¿</th>
                            <th>è‚¡æœ¬<br>å¤§å°</th>
                            <th>è½‰æ›<br>åƒ¹æ ¼</th>
                            <th>ç™¼è¡Œ<br>å¹´æœŸ</th>
                            <th>æ‰¿éŠ·<br>åˆ¸å•†</th>
                            <th>ç”¢æ¥­<br>åˆ†é¡</th>
                            <th>æ‰¿éŠ·<br>æ–¹å¼</th>
                            <th>æ›ç‰Œ<br>æœ€é«˜</th>
                            <th>æ›ç‰Œ<br>æœ€ä½</th>
                        </tr>
                    </thead>
                    <tbody id="filterTable">
                        <tr><td colspan="12">è«‹è¨­å®šç¯©é¸æ¢ä»¶</td></tr>
                    </tbody>
                    <tfoot id="filterStats" style="display: none;">
                        <tr style="background: #fff3e0; font-weight: bold;">
                            <td colspan="2">å‡å€¼</td>
                            <td id="avgSize">-</td>
                            <td>-</td>
                            <td id="avgCapital" style="font-size: 0.85em;">-</td>
                            <td id="avgConvPrice">-</td>
                            <td id="avgYear">-</td>
                            <td>-</td>
                            <td>-</td>
                            <td>-</td>
                            <td id="avgHigh">-</td>
                            <td id="avgLow">-</td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
        
        <!-- 4. æ›ç‰Œè¡¨ç¾ -->
        <div id="section4" class="section-block">
            <div class="section-title">
                <span class="icon">ğŸ“ˆ</span>æ›ç‰Œè¡¨ç¾çµ±è¨ˆ
            </div>
            
            <div class="info-card">
                <div class="title">ğŸ’¡ åŠŸèƒ½èªªæ˜</div>
                <div class="text">é¡¯ç¤ºæ‰€æœ‰CBçš„æ›ç‰Œå¾Œè¡¨ç¾çµ±è¨ˆåŠæ’è¡Œæ¦œ</div>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="label">å¹³å‡æœ€é«˜åƒ¹</div>
                    <div class="value" id="avgHigh">-</div>
                </div>
                <div class="stat-card">
                    <div class="label">å¹³å‡æœ€ä½åƒ¹</div>
                    <div class="value" id="avgLow">-</div>
                </div>
                <div class="stat-card">
                    <div class="label">å¹³å‡æŒ¯å¹…</div>
                    <div class="value" id="avgSwing">-</div>
                </div>
            </div>
            
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>æ’å</th>
                            <th>CB<br>ä»£è™Ÿ</th>
                            <th>CB<br>åç¨±</th>
                            <th>æ‰¿éŠ·<br>æ–¹å¼</th>
                            <th>ç”¢æ¥­<br>åˆ†é¡</th>
                            <th>æ›ç‰Œ<br>æœ€é«˜</th>
                            <th>æ›ç‰Œ<br>æœ€ä½</th>
                            <th>åƒ¹æ ¼<br>æŒ¯å¹…</th>
                        </tr>
                    </thead>
                    <tbody id="topTable"></tbody>
                </table>
            </div>
        </div>
        
        <!-- 5. è³£å›æŸ¥è©¢ -->
        <div id="section5" class="section-block">
            <div class="section-title">
                <span class="icon">ğŸ’°</span>è³£å›æ¢ä»¶æŸ¥è©¢
            </div>
            
            <div class="info-card">
                <div class="title">ğŸ’¡ åŠŸèƒ½èªªæ˜</div>
                <div class="text">é¡¯ç¤ºæ‰€æœ‰CBçš„è³£å›æ—¥æœŸã€åƒ¹æ ¼ã€åˆ©ç‡è³‡è¨Š</div>
            </div>
            
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>CB<br>ä»£è™Ÿ</th>
                            <th>CB<br>åç¨±</th>
                            <th>æ‰¿éŠ·<br>æ–¹å¼</th>
                            <th>è³£å›<br>æ—¥æœŸ1</th>
                            <th>è³£å›<br>åƒ¹æ ¼1</th>
                            <th>åˆ©ç‡<br>(%)</th>
                            <th>è³£å›<br>æ—¥æœŸ2</th>
                            <th>è³£å›<br>åƒ¹æ ¼2</th>
                            <th>åˆ©ç‡<br>(%)</th>
                        </tr>
                    </thead>
                    <tbody id="putbackTable"></tbody>
                </table>
            </div>
        </div>
        
        <!-- 6. åŒå…¬å¸æ¯”è¼ƒ -->
        <div id="section6" class="section-block">
            <div class="section-title">
                <span class="icon">ğŸ¢</span>åŒå…¬å¸æ¯”è¼ƒ
            </div>
            
            <div class="info-card">
                <div class="title">ğŸ’¡ åŠŸèƒ½èªªæ˜</div>
                <div class="text">æŸ¥è©¢æ–¹å¼:è¼¸å…¥è‚¡ç¥¨ä»£è™Ÿ,é¡¯ç¤ºè©²å…¬å¸æ‰€æœ‰ç™¼è¡Œçš„CB</div>
                <div class="text">ä½¿ç”¨ç¯„ä¾‹:è¼¸å…¥ã€Œ8070ã€æŸ¥è©¢é•·æ¦®èˆªæ‰€æœ‰CBçš„æ¯”è¼ƒ</div>
            </div>
            

            
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>CB<br>ä»£è™Ÿ</th>
                            <th>CB<br>åç¨±</th>
                            <th>ç™¼è¡Œ<br>è¦æ¨¡</th>
                            <th>æœ‰ç„¡<br>æ“”ä¿</th>
                            <th>ç™¼è¡Œ<br>å¹´æœŸ</th>
                            <th>è½‰æ›<br>åƒ¹æ ¼</th>
                            <th>æ‰¿éŠ·<br>æ–¹å¼</th>
                            <th>æ›ç‰Œ<br>æœ€é«˜</th>
                            <th>æ›ç‰Œ<br>æœ€ä½</th>
                        </tr>
                    </thead>
                    <tbody id="companyTable">
                        <tr><td colspan="9">è«‹è¼¸å…¥è‚¡ç¥¨ä»£è™Ÿé€²è¡ŒæŸ¥è©¢</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- 7. æ™‚é–“è»¸æŸ¥è©¢ -->
        <div id="section7" class="section-block">
            <div class="section-title">
                <span class="icon">ğŸ“…</span>æ™‚é–“è»¸æŸ¥è©¢
            </div>
            
            <div class="info-card">
                <div class="title">ğŸ’¡ åŠŸèƒ½èªªæ˜</div>
                <div class="text">æŸ¥è©¢æ–¹å¼:é¸æ“‡å¹´ä»½,é¡¯ç¤ºè©²å¹´åº¦ç™¼è¡Œçš„æ‰€æœ‰CB</div>
            </div>
            
            <div class="search-box">
                <div class="search-title">ğŸ“… é¸æ“‡å¹´ä»½</div>
                <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                    <select id="yearSelect" style="flex: 1; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 1.1em;">
                        <option value="">é¸æ“‡å¹´ä»½</option>
                        <option value="2024">2024å¹´</option>
                        <option value="2023">2023å¹´</option>
                        <option value="2022">2022å¹´</option>
                    </select>
                </div>
                <button class="search-btn" onclick="yearSearch()" style="width: 100%;">ğŸ” æŸ¥è©¢</button>
            </div>
            
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>æ›ç‰Œ<br>æ—¥æœŸ</th>
                            <th>CB<br>ä»£è™Ÿ</th>
                            <th>CB<br>åç¨±</th>
                            <th>è‚¡ç¥¨<br>ä»£è™Ÿ</th>
                            <th>ç™¼è¡Œ<br>è¦æ¨¡</th>
                            <th>æ‰¿éŠ·<br>æ–¹å¼</th>
                            <th>ç”¢æ¥­<br>åˆ†é¡</th>
                            <th>æ›ç‰Œ<br>æœ€é«˜</th>
                            <th>æ›ç‰Œ<br>æœ€ä½</th>
                        </tr>
                    </thead>
                    <tbody id="yearTable">
                        <tr><td colspan="9">è«‹é¸æ“‡å¹´ä»½é€²è¡ŒæŸ¥è©¢</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- 8. å¸‚å ´çµ±è¨ˆ -->
        <div id="section8" class="section-block">
            <div class="section-title">
                <span class="icon">ğŸ“Š</span>å¸‚å ´çµ±è¨ˆç¸½è¦½
            </div>
            
            <div class="info-card">
                <div class="title">ğŸ’¡ åŠŸèƒ½èªªæ˜</div>
                <div class="text">åˆ†æå…¨å¸‚å ´CBåœ¨ä¸åŒæ¢ä»¶ä¸‹çš„æ›ç‰Œè¡¨ç¾çµ±è¨ˆ</div>
            </div>
            
            <!-- æ•´é«”å¸‚å ´æ¦‚æ³ -->
            <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 12px; margin: 20px 0;">
                <h3 style="margin-bottom: 15px; font-size: 1.3em;">ğŸŒ æ•´é«”å¸‚å ´æ¦‚æ³</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                    <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 0.9em; opacity: 0.9;">CBç¸½æ•¸</div>
                        <div id="totalCount" style="font-size: 2em; font-weight: bold; margin-top: 5px;">-</div>
                    </div>
                    <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 0.9em; opacity: 0.9;">ç¸½ç™¼è¡Œè¦æ¨¡</div>
                        <div id="totalSize" style="font-size: 2em; font-weight: bold; margin-top: 5px;">-</div>
                    </div>
                    <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 0.9em; opacity: 0.9;">å¹³å‡æœ€é«˜åƒ¹</div>
                        <div id="avgHighAll" style="font-size: 2em; font-weight: bold; margin-top: 5px;">-</div>
                    </div>
                    <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 0.9em; opacity: 0.9;">å¹³å‡æœ€ä½åƒ¹</div>
                        <div id="avgLowAll" style="font-size: 2em; font-weight: bold; margin-top: 5px;">-</div>
                    </div>
                    <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 0.9em; opacity: 0.9;">å¹³å‡æŒ¯å¹…</div>
                        <div id="avgSwingAll" style="font-size: 2em; font-weight: bold; margin-top: 5px;">-</div>
                    </div>
                </div>
            </div>
            
            <!-- åˆ†é¡çµ±è¨ˆè¡¨æ ¼ -->
            <div style="background: white; border-radius: 12px; padding: 25px; margin: 20px 0; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <h3 style="color: #667eea; margin-bottom: 20px; font-size: 1.2em;">ğŸ“‹ åˆ†é¡çµ±è¨ˆæ¯”è¼ƒ</h3>
                
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr style="background: #667eea; color: white;">
                                <th>åˆ†é¡æ¢ä»¶</th>
                                <th>CBæ•¸é‡</th>
                                <th>ç¸½è¦æ¨¡(å„„)</th>
                                <th>å¹³å‡è¦æ¨¡(å„„)</th>
                                <th>å¹³å‡æœ€é«˜åƒ¹</th>
                                <th>å¹³å‡æœ€ä½åƒ¹</th>
                                <th>å¹³å‡æŒ¯å¹…(%)</th>
                            </tr>
                        </thead>
                        <tbody id="statsTable">
                            <tr><td colspan="7" style="text-align: center; padding: 40px;">è¼‰å…¥ä¸­...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- è©³ç´°æ•¸æ“šå±•é–‹å€ -->
            <div style="background: white; border-radius: 12px; padding: 25px; margin: 20px 0; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <h3 style="color: #667eea; margin-bottom: 20px; font-size: 1.2em;">ğŸ“ˆ ä¸åŒæ¢ä»¶ä¸‹çš„è¡¨ç¾å°æ¯”</h3>
                
                <!-- æ“”ä¿åˆ†æ -->
                <div style="margin-bottom: 30px;">
                    <h4 style="background: #f8f9fa; padding: 12px; border-left: 4px solid #667eea; margin-bottom: 15px;">ğŸ›¡ï¸ æ“”ä¿é¡å‹åˆ†æ</h4>
                    <div id="guaranteeStats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px;"></div>
                </div>
                
                <!-- å¹´æœŸåˆ†æ -->
                <div style="margin-bottom: 30px;">
                    <h4 style="background: #f8f9fa; padding: 12px; border-left: 4px solid #667eea; margin-bottom: 15px;">ğŸ“… å¹´æœŸåˆ†æ</h4>
                    <div id="yearStats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px;"></div>
                </div>
                
                <!-- è¦æ¨¡åˆ†æ -->
                <div style="margin-bottom: 30px;">
                    <h4 style="background: #f8f9fa; padding: 12px; border-left: 4px solid #667eea; margin-bottom: 15px;">ğŸ’¼ è¦æ¨¡åˆ†æ</h4>
                    <div id="sizeStats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px;"></div>
                </div>
                
                <!-- æ‰¿éŠ·å•†åˆ†æ -->
                <div>
                    <h4 style="background: #f8f9fa; padding: 12px; border-left: 4px solid #667eea; margin-bottom: 15px;">ğŸ¦ æ‰¿éŠ·åˆ¸å•†åˆ†æ</h4>
                    <div id="underwriterStats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px;"></div>
                </div>
            </div>
        </div>
        
    </div>

    <!-- é å°¾ -->
    <div class="footer">
        <p>Â© 2025 Rexå¤§å”çš„168å°è‚¡æŠ•è³‡æ•™å®¤ | CBå¯è½‰å‚µç™¼è¡Œè³‡æ–™æŸ¥è©¢ç³»çµ±</p>
        <p style="margin-top: 8px; opacity: 0.9;">è³‡æ–™åƒ…ä¾›åƒè€ƒ | æŠ•è³‡æœ‰é¢¨éšª,å…¥å¸‚éœ€è¬¹æ…</p>
    </div>

    <script>
        // å¾GitHubè¼‰å…¥è³‡æ–™
        let mockData = [];
        let isDataLoaded = false;
        
        
        function loadMockData() {
            mockData = [
                {cbCode: '29131', cbName: 'è¾²æ—ä¸€', stockCode: '2913', size: 7.5, guarantee: 'æœ‰æ“”ä¿', year: 3.0, convPrice: 17.8, listDate: '2011-05-25', maturity: '2014/05/15', high: 160.0, low: 99.5, putDate1: '-', putPrice1: 0, rate1: 0, putDate2: '-', putPrice2: 0, rate2: 0, underwriter: 'ç¦é‚¦è­‰åˆ¸', industry: 'è²¿æ˜“ç™¾è²¨æ¥­', method: 'è©¢åœˆ', capital: '79.0'},
                {cbCode: '62074', cbName: 'é›·ç§‘å››', stockCode: '6207', size: 6.0, guarantee: 'ç„¡æ“”ä¿', year: 5.0, convPrice: 53.6, listDate: '2011-05-25', maturity: '2016/05/15', high: 109.95, low: 99.0, putDate1: '-', putPrice1: 0, rate1: 0, putDate2: '-', putPrice2: 0, rate2: 0, underwriter: 'ä¸­ä¿¡è­‰åˆ¸', industry: 'é›»å­é›¶çµ„ä»¶æ¥­', method: 'è©¢åœˆ', capital: '7.97'},
                {cbCode: '23952', cbName: 'ç ”è¯äºŒ', stockCode: '2395', size: 8.0, guarantee: 'ç„¡æ“”ä¿', year: 3.0, convPrice: 94.04, listDate: '2011-05-26', maturity: '2014/05/16', high: 274.0, low: 104.0, putDate1: '-', putPrice1: 0, rate1: 0, putDate2: '-', putPrice2: 0, rate2: 0, underwriter: 'å‡±åŸºè­‰åˆ¸', industry: 'é›»è…¦åŠé€±é‚Šè¨­å‚™æ¥­', method: 'è©¢åœˆ', capital: '85.8'},
                {cbCode: '30193', cbName: 'äºå…‰ä¸‰', stockCode: '3019', size: 10.0, guarantee: 'æœ‰æ“”ä¿', year: 3.0, convPrice: 58.5, listDate: '2011-05-27', maturity: '2014/05/17', high: 110.5, low: 96.2, putDate1: '-', putPrice1: 0, rate1: 0, putDate2: '-', putPrice2: 0, rate2: 0, underwriter: 'å‡±åŸºè­‰åˆ¸', industry: 'å…‰é›»æ¥­', method: 'è©¢åœˆ', capital: '27.9'}
            ];
            isDataLoaded = true;
            console.log(`ä½¿ç”¨å…§å»ºæ¸¬è©¦è³‡æ–™: ${mockData.length} ç­†`);
            updateStatsBanner();
            document.getElementById('loadingScreen').style.display = 'none';
            showSection("section1");
        }
        
        async function loadExcelData() {
            try {
                // è³‡æ–™æºè¨­å®šï¼ˆå¯åˆ‡æ›ï¼‰
                const dataSource = "github"; // github, sheets, local
                let url = "";
                
                if (dataSource === "github") {
                    url = "https://rexdashu168.github.io/cbhistory168/cb_issue.xlsx";
                } else if (dataSource === "sheets") {
                    // Google SheetsåŒ¯å‡ºç‚ºXLSXçš„é€£çµ
                    url = "YOUR_GOOGLE_SHEETS_EXPORT_LINK";
                } else if (dataSource === "local") {
                    // ä½¿ç”¨å…§å»ºæ¸¬è©¦è³‡æ–™
                    loadMockData();
                    return;
                }
                const response = await fetch(url);
                const arrayBuffer = await response.arrayBuffer();
                const workbook = XLSX.read(arrayBuffer, { type: "array" });
                const sheet = workbook.Sheets["allcbissue"];
                const jsonData = XLSX.utils.sheet_to_json(sheet);
                
                // è½‰æ›è³‡æ–™æ ¼å¼
                mockData = jsonData.map(row => ({
                    cbCode: String(row["CBä»£è™Ÿ"] || ""),
                    cbName: row["CBåç¨±"] || "",
                    stockCode: String(row["è‚¡ç¥¨ä»£è™Ÿ"] || ""),
                    size: parseFloat(row["ç™¼è¡Œè¦æ¨¡"] || 0),
                    guarantee: row["æœ‰ç„¡æ“”ä¿"] || "",
                    year: parseFloat(row["ç™¼è¡Œå¹´æœŸ"] || 0),
                    convPrice: parseFloat(row["è½‰æ›åƒ¹æ ¼"] || 0),
                    listDate: row["æ›ç‰Œæ—¥æœŸ"] || "",
                    maturity: row["åˆ°æœŸæ—¥æœŸ"] || "",
                    high: parseFloat(row["æ›ç‰Œæœ€é«˜"] || 0),
                    low: parseFloat(row["æ›ç‰Œæœ€ä½"] || 0),
                    putDate1: row["è³£å›æ—¥æœŸ1"] || "-",
                    putPrice1: parseFloat(row["è³£å›åƒ¹æ ¼1"] || 0),
                    rate1: parseFloat(row["æ®–åˆ©ç‡1"] || 0),
                    putDate2: row["è³£å›æ—¥æœŸ2"] || "-",
                    putPrice2: parseFloat(row["è³£å›åƒ¹æ ¼2"] || 0),
                    rate2: parseFloat(row["æ®–åˆ©ç‡2"] || 0),
                    underwriter: row["æ‰¿éŠ·åˆ¸å•†"] || "",
                    industry: row["ç”¢æ¥­åˆ†é¡"] || "",
                    method: row["æ‰¿éŠ·æ–¹å¼"] || "",
                    capital: String(row["è‚¡æœ¬è¦æ¨¡"] || "")
                }));
                
                isDataLoaded = true;
                console.log(`æˆåŠŸè¼‰å…¥ ${mockData.length} ç­†è³‡æ–™`);
                
                // æ›´æ–°çµ±è¨ˆæ©«å¹…
                updateStatsBanner();
                
                // è³‡æ–™è¼‰å…¥å®Œæˆå¾Œç§»é™¤loadingä¸¦åˆå§‹åŒ–
                document.getElementById('loadingScreen').style.display = 'none';
                showSection("section1");
                
            } catch (error) {
                console.error("è¼‰å…¥è³‡æ–™å¤±æ•—:", error);
                alert("è³‡æ–™è¼‰å…¥å¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯é€£ç·šæˆ–ç¨å¾Œå†è©¦");
            }
        }
        
        function updateStatsBanner() {
            if (mockData.length === 0) return;
            
            // æ‰¾å‡ºæœ€æ—©å’Œæœ€æ™šçš„æ›ç‰Œæ—¥æœŸ
            const dates = mockData.map(d => d.listDate).filter(d => d).sort();
            const startDate = dates[0] || '';
            const endDate = dates[dates.length - 1] || '';
            
            const banner = document.getElementById('statsBanner');
            banner.innerHTML = `ğŸ“Š è³‡æ–™æœŸé–“:${startDate}ï½${endDate},å…±è¨ˆ <strong>${mockData.length}</strong> æª” | ğŸ’° è³‡æ–™æ›´æ–°:${new Date().toLocaleDateString('zh-TW')}`;
        }
        
        
        // æ•¸å­—æ ¼å¼åŒ–å‡½æ•¸
        function formatNumber(num) {
            if (num === '-' || num === '' || num === null || num === undefined) return '-';
            const n = parseFloat(num);
            if (isNaN(n)) return '-';
            return n.toFixed(1);  // æ”¹ç‚ºä¸€ä½å°æ•¸
        }
        
        // é¡¯ç¤ºç•¶å‰æ—¥æœŸ
        function updateDate() {
            const now = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long' };
            document.getElementById('currentDate').textContent = now.toLocaleDateString('zh-TW', options);
        }
        updateDate();
        
        // åˆ‡æ›åŠŸèƒ½å€å¡Š
        function switchSection(sectionId, index) {
            // æ¸…ç©ºæ‰€æœ‰çµæœå€
            document.querySelectorAll('[id^="result"]').forEach(el => {
                el.innerHTML = '';
            });
            
            document.querySelectorAll('.section-block').forEach(block => {
                block.classList.remove('active');
            });
            
            document.getElementById(sectionId).classList.add('active');
            
            document.querySelectorAll('.function-item').forEach((item, i) => {
                if (i === index) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
            
            if (sectionId === 'section4') initPerformance();
            if (sectionId === 'section5') initPutback();
            if (sectionId === 'section8') initMarketStats();
        }
        
        // å–®æª”æŸ¥è©¢
        function searchCB() {
            const input = document.getElementById('companyInput').value.trim();
            if (!input) { alert('è«‹è¼¸å…¥ä»£è™Ÿ'); return; }
            
            const result = input.length === 5 ? 
                mockData.find(d => d.cbCode === input) :
                mockData.find(d => d.stockCode === input);
            
            if (!result) { 
                document.getElementById('result1').innerHTML = '<div style="text-align:center; padding:40px; color:#999;">æŸ¥ç„¡è³‡æ–™</div>';
                return; 
            }
            
            const swing = ((result.high - result.low) / result.low * 100).toFixed(1);
            
            // ä¸€é é€šå®Œæ•´ç‰ˆé¢
            document.getElementById('result1').innerHTML = `
                <!-- CBæ¨™é¡Œæ¬„ -->
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px 30px; border-radius: 12px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 20px;">
                    <div>
                        <h1 style="font-size: 2.2em; margin-bottom: 8px;">${result.cbCode} ${result.cbName}</h1>
                        <p style="font-size: 1.1em; opacity: 0.95;">${result.stockCode} | ${result.industry} | ${result.underwriter}ä¸»è¾¦</p>
                    </div>
                    <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                        <div style="background: rgba(255,255,255,0.2); padding: 12px 20px; border-radius: 8px; text-align: center; min-width: 100px;">
                            <div style="font-size: 0.85em; opacity: 0.9; margin-bottom: 5px;">æ›ç‰Œæœ€é«˜</div>
                            <div style="font-size: 1.6em; font-weight: bold; color: #ffeb3b;">${formatNumber(result.high)}</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.2); padding: 12px 20px; border-radius: 8px; text-align: center; min-width: 100px;">
                            <div style="font-size: 0.85em; opacity: 0.9; margin-bottom: 5px;">æ›ç‰Œæœ€ä½</div>
                            <div style="font-size: 1.6em; font-weight: bold; color: #4caf50;">${formatNumber(result.low)}</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.2); padding: 12px 20px; border-radius: 8px; text-align: center; min-width: 100px;">
                            <div style="font-size: 0.85em; opacity: 0.9; margin-bottom: 5px;">åƒ¹æ ¼æŒ¯å¹…</div>
                            <div style="font-size: 1.6em; font-weight: bold;">${swing}%</div>
                        </div>
                    </div>
                </div>
                
                <!-- åŸºæœ¬æ¢æ¬¾ -->
                <div style="background: white; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); overflow: hidden;">
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 15px 25px; font-size: 1.3em; font-weight: bold;">ğŸ“‹ åŸºæœ¬æ¢æ¬¾</div>
                    <div style="padding: 25px;">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                            <div style="background: #f8f9fa; padding: 12px 15px; border-radius: 8px; border-left: 4px solid #667eea;">
                                <div style="font-size: 0.85em; color: #666; margin-bottom: 5px;">ç™¼è¡Œè¦æ¨¡(å„„å…ƒ)</div>
                                <div style="font-size: 1.15em; font-weight: bold; color: #667eea;">${formatNumber(result.size)}</div>
                            </div>
                            <div style="background: #f8f9fa; padding: 12px 15px; border-radius: 8px; border-left: 4px solid #667eea;">
                                <div style="font-size: 0.85em; color: #666; margin-bottom: 5px;">ç™¼è¡Œå¹´æ•¸</div>
                                <div style="font-size: 1.15em; font-weight: bold;">${result.year}å¹´</div>
                            </div>
                            <div style="background: #f8f9fa; padding: 12px 15px; border-radius: 8px; border-left: 4px solid #667eea;">
                                <div style="font-size: 0.85em; color: #666; margin-bottom: 5px;">æ˜¯å¦æœ‰æ“”ä¿</div>
                                <div style="font-size: 1.15em; font-weight: bold; color: ${result.guarantee === 'æœ‰æ“”ä¿' ? '#2196f3' : '#f57c00'};">${result.guarantee}</div>
                            </div>
                            <div style="background: #f8f9fa; padding: 12px 15px; border-radius: 8px; border-left: 4px solid #667eea;">
                                <div style="font-size: 0.85em; color: #666; margin-bottom: 5px;">æ‰¿éŠ·æ–¹å¼</div>
                                <div style="font-size: 1.15em; font-weight: bold; color: ${result.method === 'ç«¶æ‹' ? '#c2185b' : '#1976d2'};">${result.method}</div>
                            </div>
                            <div style="background: #f8f9fa; padding: 12px 15px; border-radius: 8px; border-left: 4px solid #667eea;">
                                <div style="font-size: 0.85em; color: #666; margin-bottom: 5px;">æ›ç‰Œæ—¥æœŸ</div>
                                <div style="font-size: 1.15em; font-weight: bold;">${result.listDate}</div>
                            </div>
                            <div style="background: #f8f9fa; padding: 12px 15px; border-radius: 8px; border-left: 4px solid #667eea;">
                                <div style="font-size: 0.85em; color: #666; margin-bottom: 5px;">åˆ°æœŸæ—¥</div>
                                <div style="font-size: 1.15em; font-weight: bold;">${result.maturity}</div>
                            </div>
                            <div style="background: #f8f9fa; padding: 12px 15px; border-radius: 8px; border-left: 4px solid #667eea;">
                                <div style="font-size: 0.85em; color: #666; margin-bottom: 5px;">è‚¡æœ¬(å„„å…ƒ)</div>
                                <div style="font-size: 1.15em; font-weight: bold;">${formatNumber(result.capital)}</div>
                            </div>
                            <div style="background: #f8f9fa; padding: 12px 15px; border-radius: 8px; border-left: 4px solid #667eea;">
                                <div style="font-size: 0.85em; color: #666; margin-bottom: 5px;">ç”¢æ¥­åˆ†é¡</div>
                                <div style="font-size: 1.15em; font-weight: bold;">${result.industry}</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- è½‰æ›æ¢æ¬¾ -->
                <div style="background: white; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); overflow: hidden;">
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 15px 25px; font-size: 1.3em; font-weight: bold;">ğŸ”„ è½‰æ›æ¢æ¬¾</div>
                    <div style="padding: 25px;">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                            <div style="background: #f8f9fa; padding: 12px 15px; border-radius: 8px; border-left: 4px solid #667eea;">
                                <div style="font-size: 0.85em; color: #666; margin-bottom: 5px;">è½‰æ›åƒ¹æ ¼(å…ƒ)</div>
                                <div style="font-size: 1.3em; font-weight: bold; color: #667eea;">${formatNumber(result.convPrice)}</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- è³£å›æ¢ä»¶ -->
                <div style="background: white; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); overflow: hidden;">
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 15px 25px; font-size: 1.3em; font-weight: bold;">â†©ï¸ è³£å›æ¢ä»¶</div>
                    <div style="padding: 25px;">
                        <table style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr>
                                    <th style="background: #667eea; color: white; padding: 12px; text-align: center;">è³£å›æ¬¡æ•¸</th>
                                    <th style="background: #667eea; color: white; padding: 12px; text-align: center;">è³£å›æ—¥æœŸ</th>
                                    <th style="background: #667eea; color: white; padding: 12px; text-align: center;">è³£å›åƒ¹æ ¼</th>
                                    <th style="background: #667eea; color: white; padding: 12px; text-align: center;">åˆ©ç‡(%)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td style="padding: 12px; text-align: center; border-bottom: 1px solid #eee;"><strong>è³£å›1</strong></td>
                                    <td style="padding: 12px; text-align: center; border-bottom: 1px solid #eee;">${result.putDate1}</td>
                                    <td style="padding: 12px; text-align: center; border-bottom: 1px solid #eee;">${formatNumber(result.putPrice1)}</td>
                                    <td style="padding: 12px; text-align: center; border-bottom: 1px solid #eee;">${formatNumber(result.rate1)}%</td>
                                </tr>
                                <tr>
                                    <td style="padding: 12px; text-align: center; border-bottom: 1px solid #eee;"><strong>è³£å›2</strong></td>
                                    <td style="padding: 12px; text-align: center; border-bottom: 1px solid #eee;">${result.putDate2}</td>
                                    <td style="padding: 12px; text-align: center; border-bottom: 1px solid #eee;">${formatNumber(result.putPrice2)}</td>
                                    <td style="padding: 12px; text-align: center; border-bottom: 1px solid #eee;">${formatNumber(result.rate2)}%</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- æ›ç‰Œè¡¨ç¾ -->
                <div style="background: white; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); overflow: hidden;">
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 15px 25px; font-size: 1.3em; font-weight: bold;">ğŸ“ˆ æ›ç‰Œè¡¨ç¾çµ±è¨ˆ</div>
                    <div style="padding: 25px;">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                            <div style="background: #ffebee; padding: 12px 15px; border-radius: 8px; border-left: 4px solid #d32f2f;">
                                <div style="font-size: 0.85em; color: #666; margin-bottom: 5px;">æ›ç‰Œæœ€é«˜åƒ¹</div>
                                <div style="font-size: 1.5em; font-weight: bold; color: #d32f2f;">${formatNumber(result.high)}</div>
                            </div>
                            <div style="background: #e8f5e9; padding: 12px 15px; border-radius: 8px; border-left: 4px solid #388e3c;">
                                <div style="font-size: 0.85em; color: #666; margin-bottom: 5px;">æ›ç‰Œæœ€ä½åƒ¹</div>
                                <div style="font-size: 1.5em; font-weight: bold; color: #388e3c;">${formatNumber(result.low)}</div>
                            </div>
                            <div style="background: #fff3e0; padding: 12px 15px; border-radius: 8px; border-left: 4px solid #f57c00;">
                                <div style="font-size: 0.85em; color: #666; margin-bottom: 5px;">åƒ¹æ ¼æŒ¯å¹…</div>
                                <div style="font-size: 1.5em; font-weight: bold; color: #f57c00;">${swing}%</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // æ‰¹æ¬¡æŸ¥è©¢
        function batchSearch() {
            const input = document.getElementById('batchInput').value.trim();
            if (!input) { alert('è«‹è¼¸å…¥CBä»£è™Ÿ'); return; }
            
            const codes = input.split(',').map(c => c.trim());
            const tbody = document.getElementById('batchTable');
            tbody.innerHTML = '';
            
            codes.forEach(code => {
                const found = mockData.find(d => d.cbCode === code);
                if (found) {
                    const guaranteeText = found.guarantee === 'æœ‰æ“”ä¿' ? 
                        '<span class="guarantee-yes">æœ‰</span>' : 
                        '<span class="guarantee-no">ç„¡</span>';
                    
                    const methodText = found.method === 'ç«¶æ‹' ? 
                        '<span class="method-auction">ç«¶æ‹</span>' : 
                        '<span class="method-placement">è©¢åœˆ</span>';
                    
                    tbody.innerHTML += `
                        <tr>
                            <td><strong>${found.cbCode}</strong></td>
                            <td>${found.cbName}</td>
                            <td>${formatNumber(found.size)}å„„</td>
                            <td>${guaranteeText}</td>
                            <td>${formatNumber(found.capital)}å„„</td>
                            <td>${found.year}å¹´</td>
                            <td>${found.underwriter}</td>
                            <td>${found.industry}</td>
                            <td>${methodText}</td>
                        </tr>
                    `;
                }
            });
            
            if (tbody.innerHTML === '') tbody.innerHTML = '<tr><td colspan="9">æŸ¥ç„¡è³‡æ–™</td></tr>';
        }
        
        // æ¢ä»¶ç¯©é¸
        function filterSearch() {
            const guarantee = document.getElementById('filterGuarantee').value;
            const year = document.getElementById('filterYear').value;
            const size = document.getElementById('filterSize').value;
            const capital = document.getElementById('filterCapital').value;
            const convPrice = document.getElementById('filterConvPrice').value;
            const rating = document.getElementById('filterRating').value;
            const underwriter = document.getElementById('filterUnderwriter').value;
            const industry = document.getElementById('filterIndustry').value;
            const method = document.getElementById('filterMethod').value;
            
            let results = mockData;
            
            // ç¬¬ä¸€æ’ç¯©é¸
            if (guarantee) results = results.filter(d => d.guarantee === guarantee);
            if (year) results = results.filter(d => d.year == year);
            if (size) {
                // å…­åˆ†ä½ç¯©é¸ï¼šè¦æ¨¡ (æ•´æ•¸å€é–“)
                const sizeRanges = {
                    '1': [1, 3],
                    '2': [3, 5],
                    '3': [5, 8],
                    '4': [8, 10],
                    '5': [10, 999]
                };
                const [min, max] = sizeRanges[size];
                results = results.filter(d => d.size >= min && d.size < max);
            }
            
            // ç¬¬äºŒæ’ç¯©é¸
            if (capital) {
                // å…­åˆ†ä½ç¯©é¸ï¼šè‚¡æœ¬ (æ•´æ•¸å€é–“)
                const capitalRanges = {
                    '1': [7, 10],
                    '2': [10, 15],
                    '3': [15, 30],
                    '4': [30, 60],
                    '5': [60, 9999]
                };
                const [min, max] = capitalRanges[capital];
                results = results.filter(d => {
                    const cap = parseFloat(d.capital);
                    return cap >= min && cap < max;
                });
            }
            if (convPrice) {
                // å…­åˆ†ä½ç¯©é¸ï¼šè½‰æ›åƒ¹æ ¼ (æ•´æ•¸å€é–“)
                const convRanges = {
                    '1': [10, 15],
                    '2': [15, 20],
                    '3': [20, 30],
                    '4': [30, 40],
                    '5': [40, 60],
                    '6': [60, 9999]
                };
                const [min, max] = convRanges[convPrice];
                results = results.filter(d => d.convPrice >= min && d.convPrice < max);
            }
            // ratingç¯©é¸ä¿ç•™çµ¦æœªä¾†æ“´å……
            
            // ç¬¬ä¸‰æ’ç¯©é¸
            if (underwriter) results = results.filter(d => d.underwriter === underwriter);
            if (industry) results = results.filter(d => d.industry === industry);
            if (method) results = results.filter(d => d.method === method);
            
            const tbody = document.getElementById('filterTable');
            tbody.innerHTML = '';
            
            if (results.length === 0) {
                tbody.innerHTML = '<tr><td colspan="12">æŸ¥ç„¡ç¬¦åˆæ¢ä»¶çš„è³‡æ–™</td></tr>';
                document.getElementById('filterStats').style.display = 'none';
                return;
            }
            
            results.forEach(d => {
                const guaranteeText = d.guarantee === 'æœ‰æ“”ä¿' ? 
                    '<span class="guarantee-yes">æœ‰</span>' : 
                    '<span class="guarantee-no">ç„¡</span>';
                
                const methodText = d.method === 'ç«¶æ‹' ? 
                    '<span class="method-auction">ç«¶æ‹</span>' : 
                    '<span class="method-placement">è©¢åœˆ</span>';
                
                tbody.innerHTML += `
                    <tr>
                        <td><strong>${d.cbCode}</strong></td>
                        <td>${d.cbName}</td>
                        <td>${formatNumber(d.size)}å„„</td>
                        <td>${guaranteeText}</td>
                        <td style="font-size: 0.85em;">${formatNumber(d.capital)}å„„</td>
                        <td>${formatNumber(d.convPrice)}</td>
                        <td>${d.year}å¹´</td>
                        <td>${d.underwriter}</td>
                        <td>${d.industry}</td>
                        <td>${methodText}</td>
                        <td class="${d.high > 150 ? 'highlight-red' : ''}">${formatNumber(d.high)}</td>
                        <td class="${d.low < 100 ? 'highlight-green' : ''}">${formatNumber(d.low)}</td>
                    </tr>
                `;
            });
            
            // è¨ˆç®—çµ±è¨ˆå€¼
            const avgSize = (results.reduce((s, d) => s + d.size, 0) / results.length).toFixed(1);
            const avgCapital = (results.reduce((s, d) => s + parseFloat(d.capital), 0) / results.length).toFixed(1);
            const avgConvPrice = (results.reduce((s, d) => s + d.convPrice, 0) / results.length).toFixed(1);
            const avgYear = (results.reduce((s, d) => s + d.year, 0) / results.length).toFixed(1);
            const avgHigh = (results.reduce((s, d) => s + d.high, 0) / results.length).toFixed(1);
            const avgLow = (results.reduce((s, d) => s + d.low, 0) / results.length).toFixed(1);
            
            document.getElementById('avgSize').textContent = avgSize + 'å„„';
            document.getElementById('avgCapital').textContent = avgCapital + 'å„„';
            document.getElementById('avgConvPrice').textContent = avgConvPrice + 'å…ƒ';
            document.getElementById('avgYear').textContent = avgYear + 'å¹´';
            document.getElementById('avgHigh').textContent = avgHigh;
            document.getElementById('avgLow').textContent = avgLow;
            document.getElementById('filterStats').style.display = '';
        }
        
        // æ›ç‰Œè¡¨ç¾çµ±è¨ˆ
        function initPerformance() {
            const avgH = (mockData.reduce((s, d) => s + d.high, 0) / mockData.length).toFixed(2);
            const avgL = (mockData.reduce((s, d) => s + d.low, 0) / mockData.length).toFixed(2);
            const swings = mockData.map(d => (d.high - d.low) / d.low * 100);
            const avgS = (swings.reduce((s, v) => s + v, 0) / swings.length).toFixed(1);
            
            document.getElementById('avgHigh').textContent = avgH;
            document.getElementById('avgLow').textContent = avgL;
            document.getElementById('avgSwing').textContent = avgS + '%';
            
            const sorted = [...mockData].sort((a, b) => b.high - a.high).slice(0, 10);
            const tbody = document.getElementById('topTable');
            tbody.innerHTML = '';
            sorted.forEach((d, i) => {
                const swing = ((d.high - d.low) / d.low * 100).toFixed(1);
                
                const methodText = d.method === 'ç«¶æ‹' ? 
                    '<span class="method-auction">ç«¶æ‹</span>' : 
                    '<span class="method-placement">è©¢åœˆ</span>';
                
                tbody.innerHTML += `
                    <tr>
                        <td><strong>${i + 1}</strong></td>
                        <td>${d.cbCode}</td>
                        <td>${d.cbName}</td>
                        <td>${methodText}</td>
                        <td>${d.industry}</td>
                        <td class="highlight-red">${formatNumber(d.high)}</td>
                        <td class="highlight-green">${formatNumber(d.low)}</td>
                        <td><strong>${swing}%</strong></td>
                    </tr>
                `;
            });
        }
        
        // è³£å›æŸ¥è©¢
        function initPutback() {
            const tbody = document.getElementById('putbackTable');
            tbody.innerHTML = '';
            mockData.forEach(d => {
                const methodText = d.method === 'ç«¶æ‹' ? 
                    '<span class="method-auction">ç«¶æ‹</span>' : 
                    '<span class="method-placement">è©¢åœˆ</span>';
                
                tbody.innerHTML += `
                    <tr>
                        <td><strong>${d.cbCode}</strong></td>
                        <td>${d.cbName}</td>
                        <td>${methodText}</td>
                        <td>${d.putDate1}</td>
                        <td>${d.putPrice1}</td>
                        <td>${d.rate1}%</td>
                        <td>${d.putDate2}</td>
                        <td>${d.putPrice2}</td>
                        <td>${d.rate2}%</td>
                    </tr>
                `;
            });
        }
        
        // åŒå…¬å¸æ¯”è¼ƒ
        function companySearch() {
            const input = document.getElementById('searchInput1').value.trim();
            if (!input) { alert('è«‹è¼¸å…¥è‚¡ç¥¨ä»£è™Ÿ'); return; }
            
            const results = mockData.filter(d => d.stockCode === input);
            const tbody = document.getElementById('companyTable');
            tbody.innerHTML = '';
            
            if (results.length === 0) {
                tbody.innerHTML = '<tr><td colspan="9">æŸ¥ç„¡è³‡æ–™</td></tr>';
                return;
            }
            
            results.forEach(d => {
                const guaranteeText = d.guarantee === 'æœ‰æ“”ä¿' ? 
                    '<span class="guarantee-yes">æœ‰</span>' : 
                    '<span class="guarantee-no">ç„¡</span>';
                
                const methodText = d.method === 'ç«¶æ‹' ? 
                    '<span class="method-auction">ç«¶æ‹</span>' : 
                    '<span class="method-placement">è©¢åœˆ</span>';
                
                tbody.innerHTML += `
                    <tr>
                        <td><strong>${d.cbCode}</strong></td>
                        <td>${d.cbName}</td>
                        <td>${formatNumber(d.size)}å„„</td>
                        <td>${guaranteeText}</td>
                        <td>${d.year}å¹´</td>
                        <td>${formatNumber(d.convPrice)}</td>
                        <td>${methodText}</td>
                        <td class="${d.high > 150 ? 'highlight-red' : ''}">${formatNumber(d.high)}</td>
                        <td class="${d.low < 100 ? 'highlight-green' : ''}">${formatNumber(d.low)}</td>
                    </tr>
                `;
            });
        }
        
        // æ™‚é–“è»¸æŸ¥è©¢
        function yearSearch() {
            const year = document.getElementById('yearSelect').value;
            if (!year) { alert('è«‹é¸æ“‡å¹´ä»½'); return; }
            
            const results = mockData.filter(d => d.listDate.includes(year));
            const tbody = document.getElementById('yearTable');
            tbody.innerHTML = '';
            
            if (results.length === 0) {
                tbody.innerHTML = '<tr><td colspan="9">æŸ¥ç„¡è³‡æ–™</td></tr>';
                return;
            }
            
            results.sort((a, b) => new Date(a.listDate) - new Date(b.listDate));
            results.forEach(d => {
                const methodText = d.method === 'ç«¶æ‹' ? 
                    '<span class="method-auction">ç«¶æ‹</span>' : 
                    '<span class="method-placement">è©¢åœˆ</span>';
                
                tbody.innerHTML += `
                    <tr>
                        <td>${d.listDate}</td>
                        <td><strong>${d.cbCode}</strong></td>
                        <td>${d.cbName}</td>
                        <td>${d.stockCode}</td>
                        <td>${formatNumber(d.size)}å„„</td>
                        <td>${methodText}</td>
                        <td>${d.industry}</td>
                        <td class="${d.high > 150 ? 'highlight-red' : ''}">${formatNumber(d.high)}</td>
                        <td class="${d.low < 100 ? 'highlight-green' : ''}">${formatNumber(d.low)}</td>
                    </tr>
                `;
            });
        }
        
        // å¸‚å ´çµ±è¨ˆ
        // å¸‚å ´çµ±è¨ˆåˆå§‹åŒ–
        function initMarketStats() {
            // è¨ˆç®—æ•´é«”æ•¸æ“š
            const total = mockData.length;
            const totalSize = mockData.reduce((s, d) => s + d.size, 0);
            const avgHigh = mockData.reduce((s, d) => s + d.high, 0) / total;
            const avgLow = mockData.reduce((s, d) => s + d.low, 0) / total;
            const avgSwing = mockData.reduce((s, d) => s + ((d.high - d.low) / d.low * 100), 0) / total;
            
            // é¡¯ç¤ºæ•´é«”æ¦‚æ³
            document.getElementById('totalCount').textContent = total + 'æª”';
            document.getElementById('totalSize').textContent = totalSize.toFixed(1) + 'å„„';
            document.getElementById('avgHighAll').textContent = avgHigh.toFixed(1);
            document.getElementById('avgLowAll').textContent = avgLow.toFixed(1);
            document.getElementById('avgSwingAll').textContent = avgSwing.toFixed(1) + '%';
            
            // ç”Ÿæˆçµ±è¨ˆè¡¨æ ¼
            generateStatsTable();
            
            // ç”Ÿæˆåˆ†é¡çµ±è¨ˆå¡ç‰‡
            generateGuaranteeStats();
            generateYearStats();
            generateSizeStats();
            generateUnderwriterStats();
        }
        
        function calculateStats(data) {
            const count = data.length;
            const totalSize = data.reduce((s, d) => s + d.size, 0);
            const avgSize = totalSize / count;
            const avgHigh = data.reduce((s, d) => s + d.high, 0) / count;
            const avgLow = data.reduce((s, d) => s + d.low, 0) / count;
            const avgSwing = data.reduce((s, d) => s + ((d.high - d.low) / d.low * 100), 0) / count;
            return { count, totalSize, avgSize, avgHigh, avgLow, avgSwing };
        }
        
        function generateStatsTable() {
            const tbody = document.getElementById('statsTable');
            tbody.innerHTML = '';
            
            // å…¨éƒ¨
            const all = calculateStats(mockData);
            tbody.innerHTML += `
                <tr style="background: #f8f9fa; font-weight: bold;">
                    <td>ğŸ“Š å…¨éƒ¨CB</td>
                    <td>${all.count}</td>
                    <td>${all.totalSize.toFixed(1)}</td>
                    <td>${all.avgSize.toFixed(1)}</td>
                    <td>${all.avgHigh.toFixed(1)}</td>
                    <td>${all.avgLow.toFixed(1)}</td>
                    <td>${all.avgSwing.toFixed(1)}</td>
                </tr>
            `;
            
            // æœ‰æ“”ä¿
            const guaranteed = calculateStats(mockData.filter(d => d.guarantee === 'æœ‰æ“”ä¿'));
            tbody.innerHTML += `
                <tr>
                    <td>ğŸ›¡ï¸ æœ‰æ“”ä¿</td>
                    <td>${guaranteed.count}</td>
                    <td>${guaranteed.totalSize.toFixed(1)}</td>
                    <td>${guaranteed.avgSize.toFixed(1)}</td>
                    <td style="color: #2196f3; font-weight: bold;">${guaranteed.avgHigh.toFixed(1)}</td>
                    <td>${guaranteed.avgLow.toFixed(1)}</td>
                    <td>${guaranteed.avgSwing.toFixed(1)}</td>
                </tr>
            `;
            
            // ç„¡æ“”ä¿
            const noGuarantee = calculateStats(mockData.filter(d => d.guarantee === 'ç„¡æ“”ä¿'));
            tbody.innerHTML += `
                <tr>
                    <td>âš ï¸ ç„¡æ“”ä¿</td>
                    <td>${noGuarantee.count}</td>
                    <td>${noGuarantee.totalSize.toFixed(1)}</td>
                    <td>${noGuarantee.avgSize.toFixed(1)}</td>
                    <td style="color: #2196f3; font-weight: bold;">${noGuarantee.avgHigh.toFixed(1)}</td>
                    <td>${noGuarantee.avgLow.toFixed(1)}</td>
                    <td>${noGuarantee.avgSwing.toFixed(1)}</td>
                </tr>
            `;
            
            // 3å¹´æœŸ
            const year3 = calculateStats(mockData.filter(d => d.year === 3));
            tbody.innerHTML += `
                <tr>
                    <td>ğŸ“… 3å¹´æœŸ</td>
                    <td>${year3.count}</td>
                    <td>${year3.totalSize.toFixed(1)}</td>
                    <td>${year3.avgSize.toFixed(1)}</td>
                    <td style="color: #ff9800; font-weight: bold;">${year3.avgHigh.toFixed(1)}</td>
                    <td>${year3.avgLow.toFixed(1)}</td>
                    <td>${year3.avgSwing.toFixed(1)}</td>
                </tr>
            `;
            
            // 5å¹´æœŸ
            const year5 = calculateStats(mockData.filter(d => d.year === 5));
            tbody.innerHTML += `
                <tr>
                    <td>ğŸ“… 5å¹´æœŸ</td>
                    <td>${year5.count}</td>
                    <td>${year5.totalSize.toFixed(1)}</td>
                    <td>${year5.avgSize.toFixed(1)}</td>
                    <td style="color: #ff9800; font-weight: bold;">${year5.avgHigh.toFixed(1)}</td>
                    <td>${year5.avgLow.toFixed(1)}</td>
                    <td>${year5.avgSwing.toFixed(1)}</td>
                </tr>
            `;
            
            // å¤§è¦æ¨¡
            const large = calculateStats(mockData.filter(d => d.size >= 10));
            tbody.innerHTML += `
                <tr>
                    <td>ğŸ’¼ å¤§è¦æ¨¡(â‰¥10å„„)</td>
                    <td>${large.count}</td>
                    <td>${large.totalSize.toFixed(1)}</td>
                    <td>${large.avgSize.toFixed(1)}</td>
                    <td style="color: #4caf50; font-weight: bold;">${large.avgHigh.toFixed(1)}</td>
                    <td>${large.avgLow.toFixed(1)}</td>
                    <td>${large.avgSwing.toFixed(1)}</td>
                </tr>
            `;
            
            // å°è¦æ¨¡
            const small = calculateStats(mockData.filter(d => d.size < 5));
            tbody.innerHTML += `
                <tr>
                    <td>ğŸ’¼ å°è¦æ¨¡(<5å„„)</td>
                    <td>${small.count}</td>
                    <td>${small.totalSize.toFixed(1)}</td>
                    <td>${small.avgSize.toFixed(1)}</td>
                    <td style="color: #4caf50; font-weight: bold;">${small.avgHigh.toFixed(1)}</td>
                    <td>${small.avgLow.toFixed(1)}</td>
                    <td>${small.avgSwing.toFixed(1)}</td>
                </tr>
            `;
        }
        
        function generateGuaranteeStats() {
            const container = document.getElementById('guaranteeStats');
            const types = ['æœ‰æ“”ä¿', 'ç„¡æ“”ä¿'];
            container.innerHTML = types.map(type => {
                const data = mockData.filter(d => d.guarantee === type);
                const stats = calculateStats(data);
                return `
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid ${type === 'æœ‰æ“”ä¿' ? '#2196f3' : '#ff9800'};">
                        <h5 style="margin-bottom: 15px; color: #333;">${type === 'æœ‰æ“”ä¿' ? 'ğŸ›¡ï¸' : 'âš ï¸'} ${type}</h5>
                        <div style="display: grid; gap: 10px;">
                            <div><strong>æ•¸é‡ï¼š</strong>${stats.count}æª”</div>
                            <div><strong>å¹³å‡è¦æ¨¡ï¼š</strong>${stats.avgSize.toFixed(1)}å„„</div>
                            <div style="color: #d32f2f; font-size: 1.2em;"><strong>å¹³å‡æœ€é«˜åƒ¹ï¼š</strong>${stats.avgHigh.toFixed(1)}</div>
                            <div><strong>å¹³å‡æœ€ä½åƒ¹ï¼š</strong>${stats.avgLow.toFixed(1)}</div>
                            <div><strong>å¹³å‡æŒ¯å¹…ï¼š</strong>${stats.avgSwing.toFixed(1)}%</div>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function generateYearStats() {
            const container = document.getElementById('yearStats');
            const years = [2.5, 3, 5];
            container.innerHTML = years.map(year => {
                const data = mockData.filter(d => d.year === year);
                if (data.length === 0) return '';
                const stats = calculateStats(data);
                return `
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #ff9800;">
                        <h5 style="margin-bottom: 15px; color: #333;">ğŸ“… ${year}å¹´æœŸ</h5>
                        <div style="display: grid; gap: 10px;">
                            <div><strong>æ•¸é‡ï¼š</strong>${stats.count}æª”</div>
                            <div><strong>å¹³å‡è¦æ¨¡ï¼š</strong>${stats.avgSize.toFixed(1)}å„„</div>
                            <div style="color: #d32f2f; font-size: 1.2em;"><strong>å¹³å‡æœ€é«˜åƒ¹ï¼š</strong>${stats.avgHigh.toFixed(1)}</div>
                            <div><strong>å¹³å‡æœ€ä½åƒ¹ï¼š</strong>${stats.avgLow.toFixed(1)}</div>
                            <div><strong>å¹³å‡æŒ¯å¹…ï¼š</strong>${stats.avgSwing.toFixed(1)}%</div>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function generateSizeStats() {
            const container = document.getElementById('sizeStats');
            const ranges = [
                { label: 'å°è¦æ¨¡(<5å„„)', filter: d => d.size < 5 },
                { label: 'ä¸­è¦æ¨¡(5-10å„„)', filter: d => d.size >= 5 && d.size < 10 },
                { label: 'å¤§è¦æ¨¡(â‰¥10å„„)', filter: d => d.size >= 10 }
            ];
            container.innerHTML = ranges.map(range => {
                const data = mockData.filter(range.filter);
                if (data.length === 0) return '';
                const stats = calculateStats(data);
                return `
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #4caf50;">
                        <h5 style="margin-bottom: 15px; color: #333;">ğŸ’¼ ${range.label}</h5>
                        <div style="display: grid; gap: 10px;">
                            <div><strong>æ•¸é‡ï¼š</strong>${stats.count}æª”</div>
                            <div><strong>ç¸½è¦æ¨¡ï¼š</strong>${stats.totalSize.toFixed(1)}å„„</div>
                            <div style="color: #d32f2f; font-size: 1.2em;"><strong>å¹³å‡æœ€é«˜åƒ¹ï¼š</strong>${stats.avgHigh.toFixed(1)}</div>
                            <div><strong>å¹³å‡æœ€ä½åƒ¹ï¼š</strong>${stats.avgLow.toFixed(1)}</div>
                            <div><strong>å¹³å‡æŒ¯å¹…ï¼š</strong>${stats.avgSwing.toFixed(1)}%</div>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function generateUnderwriterStats() {
            const container = document.getElementById('underwriterStats');
            const underwriters = [...new Set(mockData.map(d => d.underwriter))].sort();
            container.innerHTML = underwriters.map(uw => {
                const data = mockData.filter(d => d.underwriter === uw);
                const stats = calculateStats(data);
                return `
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #9c27b0;">
                        <h5 style="margin-bottom: 15px; color: #333;">ğŸ¦ ${uw}</h5>
                        <div style="display: grid; gap: 10px;">
                            <div><strong>æ•¸é‡ï¼š</strong>${stats.count}æª”</div>
                            <div><strong>ç¸½è¦æ¨¡ï¼š</strong>${stats.totalSize.toFixed(1)}å„„</div>
                            <div style="color: #d32f2f; font-size: 1.2em;"><strong>å¹³å‡æœ€é«˜åƒ¹ï¼š</strong>${stats.avgHigh.toFixed(1)}</div>
                            <div><strong>å¹³å‡æœ€ä½åƒ¹ï¼š</strong>${stats.avgLow.toFixed(1)}</div>
                            <div><strong>å¹³å‡æŒ¯å¹…ï¼š</strong>${stats.avgSwing.toFixed(1)}%</div>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        
        // Enteréµæ”¯æ´ (åªç¶å®šä¸€å®šå­˜åœ¨çš„å…ƒç´ )
        document.getElementById('searchInput1').addEventListener('keypress', e => {
            if (e.key === 'Enter') searchCB();
        });
        
        const batchInput = document.getElementById('batchInput');
        if (batchInput) {
            batchInput.addEventListener('keypress', e => {
                if (e.key === 'Enter') batchSearch();
            });
        }
    </script>

    <script>
        // é é¢è¼‰å…¥æ™‚è‡ªå‹•è¼‰å…¥Excelè³‡æ–™
        window.addEventListener('DOMContentLoaded', () => {
            loadExcelData();
        });
    </script>
</body>
</html>
